---
title: "Seguimiento PF 2017-04-20"
author: "Cristian Gómez Alvarez"
date: "17 de abril de 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Correlación y Regresión

En el siguiente ejercicio se estudiará la correlación entre el resultado de hemoglobina glicosilada (HbA1c) y la creatinina en personas diabéticas en tres periodos de tiempo independientes (sin influencia de la hemoglobina glicosilada que tiene un periodo de 3 meses de medición). Un valor controlado de HbA1c es inferior a 7% para diabéticos y de creatinina es entre 0.7 y 1.3 mg/dL para hombres y 0.6 - 1.1 mg/dL para mujeres.

Preparar librerías requeridas
````{r echo=FALSE}
### install.packages("dplyr", dependencies=TRUE) #Necesario si no se tiene la librería dplyr
### install.packages("data.table", dependencies=TRUE) #Necesario si no se tiene la librería dplyr
library(dplyr)
library(data.table)
library(ggplot2)
````

Cargar los datos(dataset completo)

```{r}
cohorte<-fread("T_Cohorte.csv", sep="\t", na.strings="NA")
```

Resumen del dataset
```{r cohorte}
summary(cohorte)
```

Los campos de nuestro interés son `idpersona`, `fecha`, `creatinina` y `hemoglobina` por lo que se descartarán los demás campos y se crearán 3 datasets de los datos para meses donde la hemoglobina no tenga influencia (examen de 3 meses de ventana).

````{r}
cohorte<-cohorte%>%select(idpersona, fecha, creatinina, hemoglobina, trigliceridos)

##Datasets
cohorte_ene<-cohorte%>%filter(fecha=="2015-01-31")
cohorte_may<-cohorte%>%filter(fecha=="2015-05-31")
cohorte_ago<-cohorte%>%filter(fecha=="2015-08-31")
````

## Correlación Enero

Gráfico de creatinina vs hemoglobina.

````{r echo=FALSE}
ggplot(data=cohorte_may, aes(x=hemoglobina, y=creatinina))+
  geom_point()+
  labs(x = "Hemoglobina", y="Creatinina")
````

Analicemos ahora qué pasa con los triglicéridos en función de la hemoglobina
````{r echo=FALSE}
ggplot(data=cohorte_ago, aes(x=hemoglobina, y=trigliceridos))+
  geom_point()+
  labs(x = "Hemoglobina", y="Triglicéridos")
````

Búsqueda de outliers. Personas que tienen una creatinina >=2.5 y hemoglobina >=13
````{r}
cohorte_ene%>%
  filter(creatinina>=2.5, hemoglobina>=13)
````

### Indice de correlación
````{r}
#0.05
cohorte_ene %>%
  summarize(N = n(), r = cor(creatinina, hemoglobina, use = "pairwise.complete.obs"))

#0.16
cohorte_may %>%
  summarize(N = n(), r = cor(hemoglobina, trigliceridos, use = "pairwise.complete.obs"))

cohorte %>%
  summarize(N = n(), r = cor(hemoglobina, trigliceridos, use = "pairwise.complete.obs"))
````